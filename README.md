# Определение стоимости автомобилей с пробегом
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE) 

## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов, позволяющее быстро оценить рыночную стоимость автомобиля. В рамках проекта была построена модель машинного обучения, предсказывающая стоимость автомобиля на основе исторических данных о технических характеристиках, комплектациях и ценах.

**Ключевые требования заказчика:**
- Высокое качество предсказания (RMSE < 2500)
- Минимизация времени обучения модели
- Оптимальное время предсказания

## Стек технологий

**Анализ данных и визуализация:**
- `pandas`, `numpy` - обработка и анализ данных
- `matplotlib`, `seaborn`, `plotly` - визуализация
- `missingno` - анализ пропущенных значений

**Машинное обучение:**
- `scikit-learn` - классические ML алгоритмы и пайплайны
- `lightgbm` - градиентный бустинг
- `category_encoders` - кодирование категориальных признаков
- `phik` - анализ корреляций

**Статистический анализ:**
- `statsmodels` - статистическое моделирование
- VIF анализ - выявление мультиколлинеарности

**Прочие инструменты:**
- `IPython` - интерактивная работа
- `warnings` - управление предупреждениями

## Основные этапы проекта

### 1. Предобработка данных
- Обработка пропущенных значений и аномалий
- Удаление неинформативных признаков
- Обработка дубликатов (явных и неявных)
- Создание новых признаков на основе существующих
- Сокращение объема датасета на 25% при сохранении информативности

### 2. Исследовательский анализ данных
- Статистическое описание данных
- Многовариантная визуализация распределений
- Анализ взаимосвязей между признаками и целевой переменной
- Выявление значимых паттернов и зависимостей

### 3. Инженерная подготовка признаков
- Разработка кастомного класса `FeatureUnionWithCatBoost` для комбинированной обработки признаков
- Применение различных стратегий кодирования:
  - One-Hot Encoding для бинарных и категориальных признаков
  - CatBoost Encoding для высококардинальных признаков
  - StandardScaler для числовых признаков

### 4. Моделирование и оценка
**Использованные алгоритмы:**
- **LightGBM** - градиентный бустинг
- **LinearRegression**, **Ridge**, **Lasso** - линейные модели
- **DecisionTreeRegressor** - дерево решений

**Метрика оценки:** RMSE (Root Mean Squared Error)

### 5. Сравнительный анализ моделей
- Оценка времени обучения и предсказания
- Анализ важности признаков
- Проверка на переобучение
- Резидуальный анализ

## Ключевые выводы

1. **Качество моделей:** Наилучшее качество предсказания демонстрирует LightGBM, однако DecisionTreeRegressor показывает оптимальное соотношение между качеством, временем обучения и предсказания.

2. **Важность признаков:** Топ-4 наиболее значимых признака:
   - `RegistrationYear` (год регистрации)
   - `Power` (мощность двигателя)
   - `brand_model` (комбинированный признак марки и модели)
   - `Kilometer` (пробег)

3. **Особенности данных:** Обнаружены нелинейные зависимости между признаками и целевой переменной, что объясняет превосходство tree-based моделей над линейными.

4. **Мультиколлинеарность:** Выявлена высокая корреляция между `VehicleType` и `FuelType`, однако эти признаки сохранены из-за их логической значимости.

## Приобретенные навыки

- **Расчет вычислительной сложности алгоритмов** - оптимизация времени выполнения
- **Градиентный спуск** - понимание и применение в контексте линейных моделей
- **Градиентный бустинг** - освоение LightGBM и тонкая настройка гиперпараметров
- **Проектирование ML-пайплайнов** - создание воспроизводимых и масштабируемых процессов
- **Комплексный анализ моделей** - оценка по множеству критериев (качество, скорость, интерпретируемость)

## Структура проекта

```bash
car-price-prediction/
│
├── notebooks/
│   ├── car_price_prediction.ipynb  # Основная тетрадка проекта
│   └── utils.py                    # Вспомогательные функции
│
├── .gitignore
├── LICENSE
├── README.md
└── requirements.txt
```

Проект включает модуль `utils.py` с набором кастомных функций для:
- Визуализации распределений и корреляций
- Анализа остатков и важности признаков
- Построения сложных пайплайнов предобработки
- Проведения статистических тестов

Все функции сопровождаются подробной документацией с примерами использования.
